Object.defineProperty(exports, "__esModule", {
  value: true
});

var _util = require('util.promisify');

var _util2 = _interopRequireDefault(_util);

var _child_process = require('child_process');

var _child_process2 = _interopRequireDefault(_child_process);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var exec = (0, _util2.default)(_child_process2.default.exec);

/**
 * Returns a git diff given a path to the repo, a commit,
 * an optional second commit, and an optional file.
 *
 * Returns the diff as a string.
 */
var gitDiff = function gitDiff(pathToRepo, commit1) {
  var commit2 = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : '';
  var file = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : '';
  return exec('git diff ' + commit1 + ' ' + commit2 + ' -- ' + file, {
    cwd: pathToRepo,
    encoding: 'utf8',
    maxBuffer: 1024 * 1000
  }).then(function (output) {
    return output.stdout;
  });
};

exports.default = gitDiff;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9naXRfZGlmZi5qcyJdLCJuYW1lcyI6WyJleGVjIiwiZ2l0RGlmZiIsInBhdGhUb1JlcG8iLCJjb21taXQxIiwiY29tbWl0MiIsImZpbGUiLCJjd2QiLCJlbmNvZGluZyIsIm1heEJ1ZmZlciIsInRoZW4iLCJvdXRwdXQiLCJzdGRvdXQiXSwibWFwcGluZ3MiOiI7Ozs7QUFBQTs7OztBQUNBOzs7Ozs7QUFFQSxJQUFNQSxPQUFPLG9CQUFVLHdCQUFhQSxJQUF2QixDQUFiOztBQUVBOzs7Ozs7QUFNQSxJQUFNQyxVQUFVLFNBQVZBLE9BQVUsQ0FBQ0MsVUFBRCxFQUFhQyxPQUFiO0FBQUEsTUFBc0JDLE9BQXRCLHVFQUFnQyxFQUFoQztBQUFBLE1BQW9DQyxJQUFwQyx1RUFBMkMsRUFBM0M7QUFBQSxTQUNkTCxtQkFBaUJHLE9BQWpCLFNBQTRCQyxPQUE1QixZQUEwQ0MsSUFBMUMsRUFBa0Q7QUFDaERDLFNBQUtKLFVBRDJDO0FBRWhESyxjQUFVLE1BRnNDO0FBR2hEQyxlQUFXLE9BQU87QUFIOEIsR0FBbEQsRUFJR0MsSUFKSCxDQUlRO0FBQUEsV0FBVUMsT0FBT0MsTUFBakI7QUFBQSxHQUpSLENBRGM7QUFBQSxDQUFoQjs7a0JBT2VWLE8iLCJmaWxlIjoiZ2l0X2RpZmYuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgcHJvbWlzaWZ5IGZyb20gJ3V0aWwucHJvbWlzaWZ5JztcbmltcG9ydCBjaGlsZFByb2Nlc3MgZnJvbSAnY2hpbGRfcHJvY2Vzcyc7XG5cbmNvbnN0IGV4ZWMgPSBwcm9taXNpZnkoY2hpbGRQcm9jZXNzLmV4ZWMpO1xuXG4vKipcbiAqIFJldHVybnMgYSBnaXQgZGlmZiBnaXZlbiBhIHBhdGggdG8gdGhlIHJlcG8sIGEgY29tbWl0LFxuICogYW4gb3B0aW9uYWwgc2Vjb25kIGNvbW1pdCwgYW5kIGFuIG9wdGlvbmFsIGZpbGUuXG4gKlxuICogUmV0dXJucyB0aGUgZGlmZiBhcyBhIHN0cmluZy5cbiAqL1xuY29uc3QgZ2l0RGlmZiA9IChwYXRoVG9SZXBvLCBjb21taXQxLCBjb21taXQyID0gJycsIGZpbGUgPSAnJykgPT5cbiAgZXhlYyhgZ2l0IGRpZmYgJHtjb21taXQxfSAke2NvbW1pdDJ9IC0tICR7ZmlsZX1gLCB7XG4gICAgY3dkOiBwYXRoVG9SZXBvLFxuICAgIGVuY29kaW5nOiAndXRmOCcsXG4gICAgbWF4QnVmZmVyOiAxMDI0ICogMTAwMFxuICB9KS50aGVuKG91dHB1dCA9PiBvdXRwdXQuc3Rkb3V0KTtcblxuZXhwb3J0IGRlZmF1bHQgZ2l0RGlmZjtcbiJdfQ==